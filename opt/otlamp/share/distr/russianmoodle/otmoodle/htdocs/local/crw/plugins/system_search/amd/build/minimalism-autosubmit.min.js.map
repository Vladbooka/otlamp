{"version":3,"sources":["../src/minimalism-autosubmit.js"],"names":["define","$","init","minform","find","join","change","data","click","focus","fitem","parents","clearTimeout","blur","setTimeout","prop","val"],"mappings":"AAAAA,OAAM,2CAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAC3B,MAAO,CAIHC,IAAI,CAAE,eAAW,IAETC,CAAAA,CAAO,CAAGF,CAAC,CAAC,uCAAD,CAFF,CAYbE,CAAO,CAACC,IAAR,CAPc,CACV,6BADU,CAEV,mEAFU,CAGV,oFAHU,CAIV,gEAJU,CAKV,4CALU,CAOD,CAAQC,IAAR,CAAa,GAAb,CAAb,EAAgCC,MAAhC,CAAuC,UAAU,CAC7C,GAAoC,QAAhC,EAAAH,CAAO,CAACI,IAAR,CAAa,cAAb,CAAJ,CACA,CACIJ,CAAO,CAACI,IAAR,CAAa,cAAb,CAA6B,QAA7B,EAAuCH,IAAvC,CAA4C,oBAA5C,EAAkEI,KAAlE,EACH,CACJ,CALD,EAWAL,CAAO,CAACC,IAAR,CAHY,CACR,oEADQ,CAGC,CAAMC,IAAN,CAAW,GAAX,CAAb,EACKI,KADL,CACW,UAAU,CACb,GAAIC,CAAAA,CAAK,CAAGT,CAAC,CAAC,IAAD,CAAD,CAAQU,OAAR,CAAgB,QAAhB,CAAZ,CACAC,YAAY,CAACF,CAAK,CAACH,IAAN,CAAW,mBAAX,CAAD,CACf,CAJL,EAKKM,IALL,CAKU,UAAU,CACZZ,CAAC,CAAC,IAAD,CAAD,CAAQU,OAAR,CAAgB,QAAhB,EAA0BJ,IAA1B,CAA+B,mBAA/B,CAAoDO,UAAU,CAAC,UAAU,CACrE,GAAoC,QAAhC,EAAAX,CAAO,CAACI,IAAR,CAAa,cAAb,CAAJ,CACA,CACIJ,CAAO,CAACI,IAAR,CAAa,cAAb,CAA6B,QAA7B,EAAuCH,IAAvC,CAA4C,oBAA5C,EAAkEI,KAAlE,EACH,CACJ,CAL6D,CAK3D,GAL2D,CAA9D,CAMH,CAZL,EAaKF,MAbL,CAaY,UAAU,CACd,GAAII,CAAAA,CAAK,CAAGT,CAAC,CAAC,IAAD,CAAD,CAAQU,OAAR,CAAgB,iBAAhB,CAAZ,CACAD,CAAK,CAACN,IAAN,CAAW,0BAAX,EAAqCW,IAArC,CAA0C,SAA1C,IACH,CAhBL,EAyBAZ,CAAO,CAACC,IAAR,CANY,CACR,0DADQ,CAER,4CAFQ,CAGR,8CAHQ,CAMC,CAAMC,IAAN,CAAW,GAAX,CAAb,EACKI,KADL,CACW,UAAU,CACbR,CAAC,CAAC,IAAD,CAAD,CAAQM,IAAR,CAAa,QAAb,CAAuBN,CAAC,CAAC,IAAD,CAAD,CAAQe,GAAR,EAAvB,CACH,CAHL,EAIKH,IAJL,CAIU,UAAU,CACZ,GAAIZ,CAAC,CAAC,IAAD,CAAD,CAAQe,GAAR,IAAiBf,CAAC,CAAC,IAAD,CAAD,CAAQM,IAAR,CAAa,QAAb,CAArB,CACA,CACI,GAAoC,QAAhC,EAAAJ,CAAO,CAACI,IAAR,CAAa,cAAb,CAAJ,CACA,CACIJ,CAAO,CAACI,IAAR,CAAa,cAAb,CAA6B,QAA7B,EAAuCH,IAAvC,CAA4C,oBAA5C,EAAkEI,KAAlE,EACH,CACJ,CACJ,CAZL,CAaH,CAjEE,CAmEV,CApEK,CAAN","sourcesContent":["define(['jquery'], function($) {\n    return {\n        /**\n         * Базовая инициализация ajax-загрузки\n         */\n        init: function() {\n\n            var minform = $('#local_crw .crw_formsearch.minimalism');\n\n            // селекты, автокомплиты, чекбоксы - отправляют форму по событию change\n            var selects = [\n                'form > .custom-field select',\n                '.fitem[data-groupname^=\"searchform_coursecontact_group\"] select',\n                '.felement[data-fieldtype=\"autocomplete\"] > select:not([name=\"topblock[crws]\"])',\n                '.fitem[data-groupname=\"bottomdate\"] input[type=\"checkbox\"]',\n                '.felement select[name=searchform_sorttype]',\n            ];\n            minform.find(selects.join(',')).change(function(){\n                if (minform.data('submit-state') != 'submit')\n                {\n                    minform.data('submit-state', 'submit').find('input[type=submit]').click();\n                }\n            });\n\n            // даты\n            var dates = [\n                '.fitem[data-groupname=\"bottomdate\"] select[name^=\"bottomdate\"]'\n            ];\n            minform.find(dates.join(','))\n                .focus(function(){\n                    var fitem = $(this).parents('.fitem');\n                    clearTimeout(fitem.data('submitFormTimeout'));\n                })\n                .blur(function(){\n                    $(this).parents('.fitem').data('submitFormTimeout', setTimeout(function(){\n                        if (minform.data('submit-state') != 'submit')\n                        {\n                            minform.data('submit-state', 'submit').find('input[type=submit]').click();\n                        }\n                    }, 500));\n                })\n                .change(function(){\n                    var fitem = $(this).parents('.fdate_selector');\n                    fitem.find('input[type=\"checkbox\"]').prop('checked', true);\n                });\n\n            // текстовые поля и сами отправляют форму по Enter, надо только потерю фокуса добавить\n            var texts = [\n                '.fitem[data-groupname=\"topblock\"] input[type=\"text\"]',\n                'form > .custom-field  input[type=\"text\"]',\n                '.fitem[data-groupname=\"bottomprice\"] input',\n            ];\n\n            minform.find(texts.join(','))\n                .focus(function(){\n                    $(this).data('oldval', $(this).val());\n                })\n                .blur(function(){\n                    if ($(this).val() != $(this).data('oldval'))\n                    {\n                        if (minform.data('submit-state') != 'submit')\n                        {\n                            minform.data('submit-state', 'submit').find('input[type=submit]').click();\n                        }\n                    }\n                });\n        }\n    };\n});"],"file":"minimalism-autosubmit.min.js"}