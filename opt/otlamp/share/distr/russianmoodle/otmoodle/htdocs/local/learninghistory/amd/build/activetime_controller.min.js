define ("local_learninghistory/activetime_controller",["core/ajax","jquery"],function(a,b){return{_timer:null,_delay:null,_userid:null,_courseid:null,_contextid:null,_overiframe:!1,startMonitoring:function startMonitoring(){var a=this;b(".block.activetimer").removeClass("noprogress").addClass("inprogress");a._changeActivetime();a._timer=setInterval(function(){a._changeActivetime()},a._delay)},_changeActivetime:function _changeActivetime(){var b=this,c=a.call([{methodname:"local_learninghistory_add_activetime_updated_log",args:{userid:b._userid,courseid:b._courseid,contextid:b._contextid}}]);c[0].fail(function(a){window.console.log(a.message)})},stopMonitoring:function stopMonitoring(){var a=this;if(a._overiframe){return}b(".block.activetimer").removeClass("inprogress").addClass("noprogress");clearInterval(a._timer)},init:function init(a,c,d,e){this._delay=1e3*parseInt(a);if(isNaN(this._delay)||1e4>this._delay){this._delay=1e4}this._userid=c;this._courseid=d;this._contextid=e;var f=this,g=function(){var a,b,c={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(a in c){if(a in document){b=c[a];break}}return function(d){if(d){document.addEventListener(b,d)}return!document[a]}}();g(function(){if(g()){setTimeout(function(){f.stopMonitoring();f.startMonitoring()},300)}else{f.stopMonitoring()}});b(function(){f.startMonitoring()});var h=document.documentMode===void 0,i=window.chrome;if(h&&!i){b(window).on("focusin",function(){f.stopMonitoring();f.startMonitoring()}).on("focusout",function(){f.stopMonitoring()})}else{if(window.addEventListener){window.addEventListener("focus",function(){f.stopMonitoring();f.startMonitoring()},!1);window.addEventListener("blur",function(){f.stopMonitoring()},!1)}else{window.attachEvent("focus",function(){f.stopMonitoring();f.startMonitoring()});window.attachEvent("blur",function(){f.stopMonitoring()})}}b("iframe").on("mouseover",{ctx:f},function(a){var b=a.data.ctx;b._overiframe=!0});b("iframe").on("mouseout",{ctx:f},function(a){var c=a.data.ctx;c._overiframe=!1;b(window).focus()})}}});
//# sourceMappingURL=activetime_controller.min.js.map
