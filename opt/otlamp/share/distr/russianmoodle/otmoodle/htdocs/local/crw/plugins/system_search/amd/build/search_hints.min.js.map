{"version":3,"sources":["../src/search_hints.js"],"names":["define","$","ajax","templates","processResults","selector","results","hints","each","index","hint","push","value","hintvalue","label","_label","transport","query","success","failure","promise","call","methodname","args","then","response","parseJSON","promises","i","render","when","apply","arguments"],"mappings":"AAuBAA,OAAM,kCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,gBAAxB,CAAD,CAA4C,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAA6B,CAE3E,MAAO,CAEHC,cAAc,CAAE,wBAASC,CAAT,CAAmBC,CAAnB,CAA4B,CACxC,GAAIC,CAAAA,CAAK,CAAG,EAAZ,CACAN,CAAC,CAACO,IAAF,CAAOF,CAAP,CAAgB,SAASG,CAAT,CAAgBC,CAAhB,CAAsB,CAClCH,CAAK,CAACI,IAAN,CAAW,CACPC,KAAK,CAAEF,CAAI,CAACG,SADL,CAEPC,KAAK,CAAEJ,CAAI,CAACK,MAFL,CAAX,CAIH,CALD,EAMA,MAAOR,CAAAA,CACV,CAXE,CAaHS,SAAS,CAAE,mBAASX,CAAT,CAAmBY,CAAnB,CAA0BC,CAA1B,CAAmCC,CAAnC,CAA4C,CAEnD,GAAIC,CAAAA,CAAO,CAAGlB,CAAI,CAACmB,IAAL,CAAU,CAAC,CACrBC,UAAU,CAAE,8BADS,CAErBC,IAAI,CAAE,CACF,MAASN,CADP,CAFe,CAAD,CAAV,CAAd,CAOAG,CAAO,CAAC,CAAD,CAAP,CAAWI,IAAX,CAAgB,SAASC,CAAT,CAAmB,IAC3BnB,CAAAA,CAAO,CAAGL,CAAC,CAACyB,SAAF,CAAYD,CAAZ,CADiB,CAG3BE,CAAQ,CAAG,EAHgB,CAI3BC,CAAC,CAAG,CAJuB,CAO/B3B,CAAC,CAACO,IAAF,CAAOF,CAAO,CAACC,KAAf,CAAsB,SAASE,CAAT,CAAgBC,CAAhB,CAAsB,CACxCiB,CAAQ,CAAChB,IAAT,CAAcR,CAAS,CAAC0B,MAAV,CAAiB,gCAAjB,CAAmDnB,CAAnD,CAAd,CACH,CAFD,EAKA,MAAOT,CAAAA,CAAC,CAAC6B,IAAF,CAAOC,KAAP,CAAa9B,CAAC,CAAC6B,IAAf,CAAqBH,CAArB,EAA+BH,IAA/B,CAAoC,UAAW,CAClD,GAAID,CAAAA,CAAI,CAAGS,SAAX,CACA/B,CAAC,CAACO,IAAF,CAAOF,CAAO,CAACC,KAAf,CAAsB,SAASE,CAAT,CAAgBC,CAAhB,CAAsB,CACxCA,CAAI,CAACK,MAAL,CAAcQ,CAAI,CAACK,CAAD,CAAlB,CACAA,CAAC,EACJ,CAHD,EAKAV,CAAO,CAACZ,CAAO,CAACC,KAAT,CACV,CARM,CAUV,CAtBD,CAsBGY,CAtBH,CAuBH,CA7CE,CA+CV,CAjDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Формирование подсказок с результатами поиска для автокоплита\n *\n * @package    local_crw\n * @subpackage crw_system_search\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/templates'], function($, ajax, templates) {\n\n    return {\n\n        processResults: function(selector, results) {\n            var hints = [];\n            $.each(results, function(index, hint) {\n                hints.push({\n                    value: hint.hintvalue,\n                    label: hint._label\n                });\n            });\n            return hints;\n        },\n\n        transport: function(selector, query, success, failure) {\n\n            var promise = ajax.call([{\n                methodname: 'crw_system_search_show_hints',\n                args: {\n                    'query': query\n                }\n            }]);\n\n            promise[0].then(function(response) {\n                var results = $.parseJSON(response);\n\n                var promises = [],\n                    i = 0;\n\n                // Render the label.\n                $.each(results.hints, function(index, hint) {\n                    promises.push(templates.render('crw_system_search/search_hints', hint));\n                });\n\n                // Apply the label to the results.\n                return $.when.apply($.when, promises).then(function() {\n                    var args = arguments;\n                    $.each(results.hints, function(index, hint) {\n                        hint._label = args[i];\n                        i++;\n                    });\n\n                    success(results.hints);\n                });\n\n            }, failure);\n        }\n    };\n});\n"],"file":"search_hints.min.js"}