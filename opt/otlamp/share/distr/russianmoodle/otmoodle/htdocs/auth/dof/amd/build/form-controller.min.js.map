{"version":3,"sources":["../src/form-controller.js"],"names":["define","$","init","self","form","fields","find","errorfields","labels","displayLabelsInActualState","displayFirstError","on","fitem","parents","css","hasClass","next","displayFirstNotEmptyWithError","call","hideAllErrors","hide","parentElement","filter","html","trim","first","attr","firstNotEmpty","val","each","visibility"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * From controller.\n *\n * @module     auth_dof/form-controller\n * @class      form-controller\n * @package    auth_dof\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      Moodle 3.5\n */\ndefine(['jquery'], function($) {\n\n    return {\n        init: function() {\n            var self = this;\n\n            self.form = $('.signup_form.mform');\n            self.fields = self.form.find('.fitem .felement');\n            self.errorfields = self.form.find('.fitem .felement input.is-invalid');\n            self.labels = self.form.find('.fitem .col-form-label');\n\n            self.displayLabelsInActualState();\n            self.displayFirstError(this.form);\n\n            self.fields.on('focus', 'input[type=\"text\"],input[type=\"password\"]', function(){\n                var fitem = $(this).parents('.fitem');\n                fitem.find('.col-form-label').css('visibility', 'visible');\n                // у паролей passwordunmask под полем есть подсказка.. на время её отображения - прячем лейбл след.эл-та\n                if (fitem.hasClass('passwordunmask')) {\n                    fitem.next().find('.col-form-label').css('visibility', 'hidden');\n                }\n            });\n            self.fields.on('blur', 'input[type=\"text\"],input[type=\"password\"]', function(){\n                self.displayLabelsInActualState();\n            });\n\n            self.errorfields.on('blur', function(){ self.displayFirstNotEmptyWithError.call(self); });\n        },\n        hideAllErrors: function(){\n            this.form.find('.fitem .invalid-feedback').hide();\n        },\n        displayFirstError: function(parentElement){\n            this.hideAllErrors();\n\n            parentElement.find('.invalid-feedback:not(#id_error_policyagreed)').filter(function(){\n                return $(this).html().trim() !== '';\n            }).first().attr('style', 'display:block!important');\n        },\n        displayFirstNotEmptyWithError: function(){\n            this.hideAllErrors();\n\n            var firstNotEmpty = this.errorfields.filter(function(){\n                return $(this).val() == '';\n            }).first().parents('.fitem');\n\n            this.displayFirstError(firstNotEmpty);\n        },\n        displayLabelsInActualState: function(){\n            this.labels.each(function(){\n                var visibility = 'visible';\n                var fitem = $(this).parents('.fitem');\n                if (!fitem.hasClass('passwordunmask')) {\n                    // у паролей passwordunmask вместо плейсхолдера подсказка с инструкцией\n                    // поэтому у них лейбл с названием поля не скрывается никогда\n                    visibility = (fitem.find('input').val() === '' ? 'hidden' : 'visible');\n                }\n                $(this).css('visibility', visibility);\n            });\n        }\n    };\n});\n"],"file":"form-controller.min.js"}