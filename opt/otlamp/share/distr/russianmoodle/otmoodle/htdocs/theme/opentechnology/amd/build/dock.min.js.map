{"version":3,"sources":["../src/dock.js"],"names":["define","$","Y","Templates","ajax","notification","__itemsCount","dock","blockicons","courseid","pagetype","pagelayout","subpage","contextid","defaulticon","handleResize","dockeditemswidth","custommenu","one","headermenuwidth","get","dockbg","body","setStyle","header","langmenu","dockdiv","positionX","positionY","dockfullwidth","dockheight","getX","parseFloat","getComputedStyle","getY","headerwidth","langmenuwidth","dockeditemtitle","getAttribute","parseInt","all","each","dockeditem","dockedtitle","removeClass","addClass","availableplace","hasClass","left","width","window","scrollY","isDockHasItems","toggleClass","find","length","hideItems","remove","showItem","triangle","appendTo","dockeditempanel","attr","top","position","outerHeight","right","outerWidth","css","offsetleft","offset","initItems","self","on","click","e","target","is","parents","first","isactive","items","setDockeditemIcon","blockinstanceid","hasOwnProperty","icon","promise","then","handleDroppedAndHit","data","dragnode","detail","dropnode","region","parent","dockedtitleclasses","dockeditemsconfig","push","slice","dockeditemData","itemnum","title","html","setting_dockeditemtitle","join","renderPromise","render","when","done","dockeditemrender","append","children","fail","console","log","handleDragStartedEarly","buttonscontainer","replace","Promise","resolve","reject","call","methodname","args","ex","exception","response","Image","onload","src","handleDraggedOverDropTarget","init"],"mappings":"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","sourcesContent":["define(\n    ['jquery', 'core/yui', 'core/templates', 'core/ajax', 'core/notification'],\n    function($, Y, Templates, ajax, notification) {\n        return {\n            // количество докедитемов используемое для создания уникальных идентификаторов\n            __itemsCount: 0,\n            // jquery-элемент дока\n            dock: null,\n            // иконки блоков\n            blockicons: {},\n            courseid: null,\n            pagetype: null,\n            pagelayout: null,\n            subpage: null,\n            contextid: null,\n            defaulticon: null,\n            handleResize: function() {\n\n                var dockeditemswidth = 0;\n                var custommenu = Y.one('#h_custommenu_wrapper label.custom_menu_mobile_label');\n                var headermenuwidth = Y.one(\"body\").get(\"winWidth\") > 425 ? 0 : (custommenu ? custommenu.get('clientWidth') : 0);\n                var dockbg = Y.one('#dock_bg');\n                var body = Y.one('body');\n                if(headermenuwidth > 0)\n                {\n                    if( dockbg !== null )\n                    {\n                        dockbg.setStyle('padding-left', headermenuwidth + 'px');\n                    }\n                } else\n                {\n                    if( dockbg !== null )\n                    {\n                        dockbg.setStyle('padding-left', null);\n                    }\n                }\n                var header = Y.one('#dock_bg h1');\n                var langmenu = Y.one('#dock_bg .langmenu_wrapper');\n                var dockdiv = Y.one('#dock');\n                var positionX = 0;\n                var positionY = 0;\n                var dockfullwidth = 0;\n                var dockheight = 0;\n                if( dockbg !== null )\n                {\n                    positionX = dockbg.getX() + parseFloat(dockbg.getComputedStyle('paddingLeft'))\n                        - parseFloat(body.getComputedStyle('marginLeft'));\n                    positionY = dockbg.getY();\n                    dockfullwidth = dockbg.get('clientWidth')\n                        - parseFloat(dockbg.getComputedStyle('paddingLeft'))\n                        - parseFloat(dockbg.getComputedStyle('paddingRight'));\n                    dockheight = dockbg.get('clientHeight');\n                }\n\n\n\n                // ширина заголовка\n                var headerwidth = 0;\n                if ( header !== null )\n                {\n                    // по умолчанию заголовок виден, чтобы мы учитывали его размер\n                    // и только если не будет влезать - спрячем потом\n                    header.setStyle('display', 'inline-block');\n                    var headerwidth = header.get('clientWidth');\n                }\n\n                // ширина панели выбора языка\n                var langmenuwidth = 0;\n                if (langmenu !== null)\n                {\n                    var langmenuwidth = langmenu.get('clientWidth');\n                }\n\n                // тип отображения док-панели\n                var dockeditemtitle = Y.one('html').getAttribute('data-dockeditem-title');\n                if( dockeditemtitle === null )\n                {\n                    dockeditemtitle = 0;\n                }\n\n                if( parseInt(dockeditemtitle) == 2 || parseInt(dockeditemtitle) == 4 )\n                {// включена настройка отображения иконок, если элементы не помещаются\n                    //включаем принудительно отображение, которое было настроено,\n                    // для просчета суммарной ширины элементов в изначальном виде\n                    var dockeditemswidth = 0;\n                    Y.all('#dock .dockeditem').each(function(dockeditem){\n                        var dockedtitle = dockeditem.one('.dockedtitle');\n                        if( parseInt(dockeditemtitle) == 2 )\n                        {// включено отображение текстом, если помещается\n                            dockedtitle.removeClass('iconview');\n                            dockedtitle.removeClass('texthide');\n                        }\n                        if( parseInt(dockeditemtitle) == 4 )\n                        {// включено отображение текст+иконки, если помещаются\n                            dockedtitle.addClass('iconview');\n                            dockedtitle.removeClass('texthide');\n                        }\n                        dockeditemswidth+=dockeditem.get('clientWidth');\n                    });\n\n                    // место под элементы док-панели\n                    var availableplace = dockfullwidth - headerwidth - (headerwidth > 0 ? 10 : 0) - langmenuwidth;\n                    if( availableplace < (dockeditemswidth + 10) )\n                    {//места под элементы меньше, чем они занимают - включаем отображение иконками\n                        dockeditemswidth = 0;\n                        // включение отображения иконками и просчет суммарной ширины в таком виде\n                        Y.all('#dock .dockeditem').each(function(dockeditem){\n                            var dockedtitle = dockeditem.one('.dockedtitle');\n                            if ( dockedtitle !== null )\n                            {\n                                if( ! dockedtitle.hasClass('noicon') )\n                                {\n                                    dockedtitle.addClass('iconview');\n                                    dockedtitle.addClass('texthide');\n                                }\n                            }\n                            dockeditemswidth+=dockeditem.get('clientWidth');\n                        });\n                    }\n                } else\n                {// просчет суммарной ширины элементов док-панели\n                    Y.all('#dock .dockeditem').each(function(dockeditem){\n                        dockeditemswidth+=dockeditem.get('clientWidth');\n                    });\n                }\n\n                // место, доступное под элементы док-панели\n                var availableplace = dockfullwidth - headerwidth - (headerwidth > 0 ? 10 : 0) - langmenuwidth;\n                if( availableplace < (dockeditemswidth + 10) )\n                {//места под элементы меньше, чем они занимают - прячем заголовок\n                    if( header !== null )\n                    {\n                        header.setStyle('display', 'none');\n                    }\n                    headerwidth = 0;\n                }\n\n                // подсчет итоговой ширины и позиции док-панели по горизонтали\n                var left = positionX + headerwidth + (headerwidth > 0 ? 10 : 0);\n                var width = dockfullwidth - headerwidth - (headerwidth > 0 ? 10 : 0) - langmenuwidth;\n\n                // установка позиции док-панели\n                if(dockdiv)\n                {\n                    if(body.hasClass('dir-rtl'))\n                    {\n                        dockdiv.setStyle('right', (left + langmenuwidth) + 'px');\n                    } else\n                    {\n                        dockdiv.setStyle('left', left + 'px');\n                    }\n\n                    if (body.hasClass('ot-sticky-enabled'))\n                    {\n                        if (dockdiv.hasClass('ot-sticky'))\n                        {\n                            positionY = positionY - window.scrollY;\n\n                        } else\n                        {\n                            if (dockbg !== null)\n                            {\n                                positionY = dockbg.get('clientTop');\n                            }\n                        }\n                    }\n                    dockdiv.setStyle('top', positionY + 'px');\n\n                    dockdiv.setStyle('width', width + 'px');\n                    dockdiv.setStyle('height', dockheight + 'px');\n                }\n            },\n            isDockHasItems: function(){\n                $('#page-header').toggleClass('dock-has-items', (this.dock.find('.dockeditem').length > 0));\n            },\n            hideItems: function(){\n                this.dock.find('#dockeditempanel').addClass('dockitempanel_hidden');\n                this.dock.find('#dockeditempanel .block').removeClass('active');\n                this.dock.find('.buttons_container .dockeditem').removeClass('active');\n                this.dock.find('.buttons_container .dockeditem .triangle').remove();\n            },\n            showItem: function(dockeditem){\n                dockeditem.addClass('active');\n                var triangle = $('<div>').addClass('triangle').appendTo(dockeditem);\n\n                var dockeditempanel = this.dock.find('#dockeditempanel');\n                dockeditempanel.removeClass('dockitempanel_hidden');\n                this.dock.find('#dockeditempanel #'+dockeditem.attr('aria-controls')).addClass('active');\n\n                var top = dockeditem.position().top + dockeditem.outerHeight() + 10;\n                var right = this.dock.outerWidth() - (dockeditem.position().left + dockeditem.outerWidth());\n                dockeditempanel.css({\n                    'top': top + 'px',\n                    'right': right + 'px',\n                    'left': 'auto',\n                    'max-height': 'calc(100vh - ' + (this.dock.position().top + top) + 'px)'\n                });\n                triangle.css({\n                    'right': (right + 15) + 'px'\n                });\n                var offsetleft = dockeditempanel.offset().left;\n                if (offsetleft < 0)\n                {\n                    dockeditempanel.css('right', right + offsetleft);\n                }\n            },\n            initItems: function(){\n\n                var self = this;\n\n                // @TODO: начать вычислять размер менюшки и как следствие докедитемпанели, а не 300px\n                $('#dock .block .action-menu-trigger').on({\n                    'show.bs.dropdown': () => {\n                        $('#dock #dockeditempanel').css('min-height', '300px');\n                    },\n                    'hide.bs.dropdown': () => {\n                        $('#dock #dockeditempanel').css('min-height', 'auto');\n                    },\n                });\n\n                $('#body-inner').click(function(e){\n                    var target = $(e.target);\n\n                    if (target.is('#dock #dockeditempanel') || target.parents('#dock #dockeditempanel').length > 0) {\n                        return;\n                    }\n\n                    var dockeditem = null;\n                    if (target.is('#dock .buttons_container .dockeditem'))\n                    {\n                        dockeditem = target;\n                    } else\n                    {\n                        var parents = target.parents('#dock .buttons_container .dockeditem');\n                        if (parents.length > 0)\n                        {\n                            dockeditem = parents.first();\n                        }\n                    }\n                    if (dockeditem !== null)\n                    {\n                        var isactive = dockeditem.hasClass('active');\n                        self.hideItems();\n                        if (!isactive)\n                        {\n                            self.showItem(dockeditem);\n                        }\n                    } else {\n                        self.hideItems();\n                    }\n\n                });\n\n                var items = self.dock.find('.buttons_container .dockeditem');\n                items.addClass('ready');\n                self.__itemsCount = items.length;\n\n            },\n            setDockeditemIcon: function(dockedtitle, blockinstanceid){\n\n                var self = this;\n\n                if (self.blockicons.hasOwnProperty(blockinstanceid) &&\n                    self.blockicons[blockinstanceid].icon !== undefined)\n                {\n                    // иконка уже подгрузилась - просто отобразим её\n                    dockedtitle.css({\n                        'background-image': 'url('+self.blockicons[blockinstanceid].icon+')'\n                    });\n                } else {\n                    // иконка еще не подгрузилась - отобразим стандартную\n                    dockedtitle.css({'background-image': 'url('+self.defaulticon+')'});\n                    // а когда подгрузится, тогда отобразим нужную\n                    self.blockicons[blockinstanceid].promise.then(function(icon){\n                        dockedtitle.css({'background-image': 'url('+icon+')'});\n                    });\n                }\n\n            },\n            handleDroppedAndHit: function(e) {\n\n                // дропнули в цель. Если убрали из дока, то спрячем докедитем, он больше не нужен\n\n                var self = e.data.dock;\n\n                var dragnode = $(e.detail.dragnode);\n                var dropnode = $(e.detail.dropnode);\n\n                var region = dropnode.data('blockregion');\n                if (!region)\n                {\n                    region = dropnode.parent().data('blockregion');\n                }\n\n                var dockeditempanel = self.dock.find('#dockeditempanel');\n\n                var dockeditem = $('.buttons_container .dockeditem[aria-controls=\"'+dragnode.attr('id')+'\"]');\n                if (region != 'dock')\n                {\n                    // дропнули блок в зону, которая не является доком\n                    dockeditempanel.removeClass('ready-to-drop');\n                    self.hideItems();\n                    dockeditem.remove();\n                    // посчитаем актуальное количество задокенных блоков и установим соответствующий класс\n                    self.isDockHasItems();\n                    self.handleResize();\n                } else if(dockeditem.length == 0) {\n                    // дропнули блок в док из другой зоны\n\n                    var dockedtitleclasses = ['dockedtitle'];\n                    var dockeditemsconfig = $('html').data('dockeditem-title');\n                    if (dockeditemsconfig == 1 || dockeditemsconfig == 3)\n                    {\n                        dockedtitleclasses.push('iconview');\n                        if (dockeditemsconfig == 1)\n                        {\n                            dockedtitleclasses.push('texthide');\n                        }\n                    }\n\n                    var blockinstanceid = dragnode.attr('id').slice(4);\n                    var dockeditemData = {\n                        itemnum: ++self.__itemsCount,\n                        title: dragnode.find('.card-title').html(),\n                        blockinstanceid: blockinstanceid,\n                        setting_dockeditemtitle: dockeditemsconfig\n                    };\n\n                    // если иконка уже получена, сразу отправим её в рендерер\n                    // если нет, запросим после рендеринга\n                    if (self.blockicons.hasOwnProperty(blockinstanceid) &&\n                        self.blockicons[blockinstanceid].icon !== undefined)\n                    {\n                        dockeditemData.icon = self.blockicons[blockinstanceid].icon;\n                    }\n\n                    dockeditemData.dockedtitleclasses = dockedtitleclasses.join(' ');\n\n                    var renderPromise = Templates.render('theme_opentechnology/dockeditem', dockeditemData);\n                    $.when(renderPromise)\n                        .done(function(dockeditemrender){\n                            dockeditempanel.removeClass('ready-to-drop');\n                            self.dock.find('.buttons_container .dockeditem_container').append(dockeditemrender);\n                            self.handleResize();\n                            var dockeditem = $('.buttons_container .dockeditem[aria-controls=\"'+dragnode.attr('id')+'\"]');\n                            if (!dockeditemData.hasOwnProperty('icon'))\n                            {\n                                // иконка до рендеринга не была определена - отобразим по возможности\n                                self.setDockeditemIcon(dockeditem.children('.dockedtitle'), blockinstanceid);\n                            }\n                            dockeditem.addClass('ready').click();\n                            // посчитаем актуальное количество задокенных блоков и установим соответствующий класс\n                            self.isDockHasItems();\n                            self.handleResize();\n\n                        }).fail(function(e){\n                            dockeditempanel.removeClass('ready-to-drop');\n                            window.console.log(e);\n                        });\n                } else {\n                    // дропнули блок в док, хотя отсюда, видать и брали\n                    dockeditempanel.removeClass('ready-to-drop');\n                    dockeditem.click();\n                    // посчитаем актуальное количество задокенных блоков и установим соответствующий класс\n                    self.isDockHasItems();\n                    self.handleResize();\n                }\n\n            },\n            handleDragStartedEarly: function(e) {\n\n                // при начале перемещения - отобразим докпанель, чтобы было куда дропать\n\n                var self = e.data.dock;\n                self.hideItems();\n\n                // притворяемся, что в доке есть итемы, чтобы было куда дропать драгаемый блок\n                $('#page-header').addClass('dock-has-items');\n                self.handleResize();\n\n                var dockeditempanel = self.dock.find('#dockeditempanel');\n                dockeditempanel.addClass('ready-to-drop');\n\n                var buttonscontainer = $('#dock .buttons_container');\n                var top = buttonscontainer.position().top + buttonscontainer.outerHeight();\n                dockeditempanel.css({\n                    'top': top + 'px',\n                    'right': '0'\n                });\n\n                var dragnode = $(e.detail.dragnode);\n                var blockinstanceid = dragnode.attr('id').replace(/inst/i, '');\n                if (!self.blockicons.hasOwnProperty(blockinstanceid))\n                {\n                    self.blockicons[blockinstanceid] = {\n                        promise: new Promise(function(resolve, reject){\n                            ajax.call([{\n                                methodname : 'theme_opentechnology_get_dock_icon',\n                                args: {\n                                    courseid: self.courseid,\n                                    pagelayout: self.pagelayout,\n                                    pagetype: self.pagetype,\n                                    subpage: self.subpage,\n                                    contextid: self.contextid,\n                                    blockinstanceid: blockinstanceid\n                                },\n                                fail: function(ex){\n                                    notification.exception(ex);\n                                    reject(ex);\n                                },\n                                done: function(response){\n                                    // сразу создаем объект изображения, чтобы картинка подгрузилась как можно раньше\n                                    var icon = new Image;\n                                    icon.onload = function(){\n                                        self.blockicons[blockinstanceid].icon = this.src;\n                                        resolve(this.src);\n                                    };\n                                    icon.src = response;\n                                }\n                            }]);\n                        })\n                    };\n                }\n            },\n            handleDraggedOverDropTarget: function(e) {\n                // блок над доком! здесь обработка, чтобы блок стало видно в док-панели\n                var dragnode = $(e.detail.dragnode);\n                if (dragnode.parents('#dock').length > 0)\n                {\n                    dragnode.addClass('active');\n                }\n            },\n            init: function(courseid, pagetype, pagelayout, subpage, contextid, defaulticon) {\n\n                this.courseid = courseid;\n                this.pagetype = pagetype;\n                this.pagelayout = pagelayout;\n                this.subpage = subpage;\n                this.contextid = contextid;\n                this.defaulticon = defaulticon;\n\n                this.dock = $('#dock');\n                $('body').addClass('has_dock').addClass('has_dock_top_horizontal');\n                this.isDockHasItems();\n                this.handleResize();\n                this.initItems();\n                $(window).on('block_drag_started_early', {dock: this}, this.handleDragStartedEarly);\n                $(window).on('block_dragged_over_drop_target', {dock: this}, this.handleDraggedOverDropTarget);\n                $(window).on('block_dropped_and_hit', {dock: this}, this.handleDroppedAndHit);\n\n                // сразу создаем объект изображения, чтобы картинка подгрузилась как можно раньше\n                var icon = new Image;\n                icon.src = this.defaulticon;\n            }\n        };\n    }\n);"],"file":"dock.min.js"}