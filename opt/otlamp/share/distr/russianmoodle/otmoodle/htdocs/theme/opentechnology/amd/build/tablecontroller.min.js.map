{"version":3,"sources":["../src/tablecontroller.js"],"names":["define","$","__table","isVisible","target","visible","rightPosition","width","offset","left","screenWidth","window","topPosition","height","top","screenHeight","dropController","parent","is","unwrap","setController","wrapper","css","wrap","topHeaderCells","find","leftHeaderCells","each","children","prop","toLowerCase","length","add","on","addClass","position","initSingleController","table","tableController","resize","init"],"mappings":"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","sourcesContent":["define(['jquery'], function($) {\n\n    return {\n        __table: null,\n\n        /**\n         * Проверка видимости элемента на странице\n         */\n        isVisible : function() {\n            var target = this.__table;\n            var visible = true;\n            var rightPosition = target.width() + target.offset().left;\n            var screenWidth = $(window).width();\n            if ( screenWidth < rightPosition )\n            {\n                //Таблица не влезает по ширине\n                visible = false;\n            }\n            var topPosition = target.height() + target.offset().top;\n            var screenHeight = $(window).height();\n            if ( screenHeight < topPosition )\n            {\n                //Таблица не влезает по высоте\n                visible = false;\n            }\n            return visible;\n        },\n\n        dropController : function() {\n            var target = this.__table;\n            if ( target.parent().is('div.tablecontroller_wrapper') )\n            {\n                target.unwrap();\n            }\n        },\n\n        setController : function() {\n            var target = this.__table;\n            this.dropController(target);\n\n            var wrapper = $('<div class=\"tablecontroller_wrapper\"></div>');\n            wrapper.css({\n                'overflow': 'auto',\n                'position' : 'relative',\n                'max-height' : $(window).height() * 0.8 + 'px'\n            });\n            target.wrap(wrapper);\n\n            var topHeaderCells = target.find('thead > tr > th');\n\n            var leftHeaderCells = [];\n            target.find('tbody > tr').each(function() {\n                $(this).children('td,th').each(function(){\n                    if( $(this).prop(\"tagName\").toLowerCase() == 'th' )\n                    {\n                        if( leftHeaderCells instanceof $ && leftHeaderCells.length > 0 )\n                        {\n                            leftHeaderCells = leftHeaderCells.add($(this));\n                        } else\n                        {\n                            leftHeaderCells = $(this);\n                        }\n                    } else\n                    {\n                        return false;\n                    }\n                });\n            });\n\n            target.parent().on('scroll', function() {\n                if( topHeaderCells instanceof $ && topHeaderCells.length > 0 )\n                {\n                    topHeaderCells.addClass('fixed');\n                    topHeaderCells.css({\n                        'top': -1 * target.position().top + 'px',\n                        'position': 'relative',\n                        'z-index' : 9999\n                    });\n                }\n                if( leftHeaderCells instanceof $ && leftHeaderCells.length > 0 )\n                {\n                    leftHeaderCells.addClass('fixed');\n                    leftHeaderCells.css({\n                        'left': -1 * target.position().left + 'px',\n                        'position': 'relative',\n                        'z-index' : 9998\n                    });\n                }\n            });\n        },\n\n        /**\n         * Инициализация контроллера для конкретной таблицы\n         */\n        initSingleController : function(table) {\n            var tableController = this;\n            tableController.__table = table;\n            $(window).on('resize', function() {\n                if ( tableController.isVisible() )\n                {\n                    // Удаление контроллера для полностью отображаемых таблиц\n                    tableController.dropController();\n                } else\n                {\n                    // Добавление контроллера для широких таблиц\n                    tableController.setController();\n                }\n            });\n            $(window).resize();\n        },\n\n        /**\n         * Базовая инициализация контроллера таблиц\n         */\n        init: function() {\n            var tableController = this;\n            $('table.generaltable').each(function(){\n                tableController.initSingleController($(this));\n            });\n        }\n    };\n});"],"file":"tablecontroller.min.js"}