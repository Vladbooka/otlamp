{"version":3,"sources":["../src/customform.js"],"names":["define","$","ajax","notification","str","init","submit","e","preventDefault","form","errors","find","length","addClass","data","serializeArray","reduce","obj","item","name","value","id","parseInt","closest","attr","replace","responses","call","methodname","args","JSON","stringify","done","get_strings","key","component","strs","alert","fail","exception","always","removeClass"],"mappings":"AAAAA,OAAM,iCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAA6C,UAA7C,CAAD,CAA2D,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgCC,CAAhC,CAAoC,CACjG,MAAO,CACHC,IAAI,CAAE,eAAW,CACbJ,CAAC,CAAC,qBAAD,CAAD,CAAyBK,MAAzB,CAAgC,SAASC,CAAT,CAAY,CACxCA,CAAC,CAACC,cAAF,GADwC,GAEpCC,CAAAA,CAAI,CAAGR,CAAC,CAAC,IAAD,CAF4B,CAGpCS,CAAM,CAAGT,CAAC,CAAC,IAAD,CAAD,CAAQU,IAAR,CAAa,QAAb,CAH2B,CAIxC,GAAoB,CAAhB,CAAAD,CAAM,CAACE,MAAX,CAAuB,CACnBH,CAAI,CAACI,QAAL,CAAc,SAAd,EADmB,GAEfC,CAAAA,CAAI,CAAGb,CAAC,CAAC,IAAD,CAAD,CAAQc,cAAR,GAAyBC,MAAzB,CAAgC,SAASC,CAAT,CAAcC,CAAd,CAAoB,CAC3DD,CAAG,CAACC,CAAI,CAACC,IAAN,CAAH,CAAiBD,CAAI,CAACE,KAAtB,CACA,MAAOH,CAAAA,CACV,CAHU,CAGR,EAHQ,CAFQ,CAMfI,CAAE,CAAGC,QAAQ,CAACrB,CAAC,CAAC,IAAD,CAAD,CAAQsB,OAAR,CAAgB,qBAAhB,EAAuCC,IAAvC,CAA4C,IAA5C,EAAkDC,OAAlD,CAA0D,MAA1D,CAAkE,EAAlE,CAAD,CANE,CAOfC,CAAS,CAAGxB,CAAI,CAACyB,IAAL,CAAU,CAAC,CACvBC,UAAU,CAAG,8BADU,CAEvBC,IAAI,CAAE,CACF,GAAOR,CADL,CAEF,KAAQS,IAAI,CAACC,SAAL,CAAejB,CAAf,CAFN,CAFiB,CAAD,CAAV,CAPG,CAcnBY,CAAS,CAAC,CAAD,CAAT,CACCM,IADD,CACM,UAAY,CACd5B,CAAG,CAAC6B,WAAJ,CAAgB,CACZ,CAAEC,GAAG,CAAE,WAAP,CAAoBC,SAAS,CAAE,oBAA/B,CADY,CAAhB,EAEGH,IAFH,CAEQ,SAASI,CAAT,CAAe,CACnBjC,CAAY,CAACkC,KAAb,CAAmB,EAAnB,CAAuBD,CAAI,CAAC,CAAD,CAA3B,CACH,CAJD,EAIGE,IAJH,CAIQnC,CAAY,CAACoC,SAJrB,EAKCC,MALD,CAKQ,UAAU,CACd/B,CAAI,CAACgC,WAAL,CAAiB,SAAjB,CACH,CAPD,CAQH,CAVD,EAWCH,IAXD,CAWM,UAAY,CACdlC,CAAG,CAAC6B,WAAJ,CAAgB,CACZ,CAAEC,GAAG,CAAE,gBAAP,CAAyBC,SAAS,CAAE,oBAApC,CADY,CAAhB,EAEGH,IAFH,CAEQ,SAASI,CAAT,CAAe,CACnBjC,CAAY,CAACkC,KAAb,CAAmB,EAAnB,CAAuBD,CAAI,CAAC,CAAD,CAA3B,CACH,CAJD,EAIGE,IAJH,CAIQnC,CAAY,CAACoC,SAJrB,EAKCC,MALD,CAKQ,UAAU,CACd/B,CAAI,CAACgC,WAAL,CAAiB,SAAjB,CACH,CAPD,CAQH,CApBD,CAqBH,CACJ,CAxCD,CAyCH,CA3CE,CA6CV,CA9CK,CAAN","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification', 'core/str'], function($, ajax, notification, str){\n    return {\n        init: function() {\n            $('.mform.otcustomform').submit(function(e) {\n                e.preventDefault();\n                var form = $(this);\n                var errors = $(this).find('.error');\n                if (errors.length < 1) {\n                    form.addClass('loading');\n                    var data = $(this).serializeArray().reduce(function(obj, item) {\n                        obj[item.name] = item.value;\n                        return obj;\n                    }, {});\n                    var id = parseInt($(this).closest('.block_otcustomform').attr('id').replace(/inst/, ''));\n                    var responses = ajax.call([{\n                        methodname : 'block_otcustomform_save_data',\n                        args: {\n                            'id' : id,\n                            'data': JSON.stringify(data)\n                        }\n                    }]);\n                    responses[0]\n                    .done(function () {\n                        str.get_strings([\n                            { key: 'formsaved', component: 'block_otcustomform' }\n                        ]).done(function(strs) {\n                            notification.alert('', strs[0]);\n                        }).fail(notification.exception)\n                        .always(function(){\n                            form.removeClass('loading');\n                        });\n                    })\n                    .fail(function () {\n                        str.get_strings([\n                            { key: 'formsavefailed', component: 'block_otcustomform' }\n                        ]).done(function(strs) {\n                            notification.alert('', strs[0]);\n                        }).fail(notification.exception)\n                        .always(function(){\n                            form.removeClass('loading');\n                        });\n                    });\n                }\n            });\n        }\n    };\n});"],"file":"customform.min.js"}