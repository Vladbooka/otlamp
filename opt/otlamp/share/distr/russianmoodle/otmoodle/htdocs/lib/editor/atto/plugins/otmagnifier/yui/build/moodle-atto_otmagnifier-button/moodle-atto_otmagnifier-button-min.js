YUI.add("moodle-atto_otmagnifier-button",function(e,t){e.namespace("M.atto_otmagnifier").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({buttonName:"otmagnifier",icon:"icon",iconComponent:"atto_otmagnifier",tags:"img",callback:this._addOrRemoveClass});var e=this;this.get("host").on("atto:selectionchanged",function(){var t=e._getImgsData();this.buttons.otmagnifier.removeClass("highlight"),t.magnified.length>0?(this.buttons.otmagnifier.addClass("has-magnified"),this.buttons.otmagnifier.addClass("highlight")):this.buttons.otmagnifier.removeClass("has-magnified"),t.notmagnified.length>0?(this.buttons.otmagnifier.addClass("has-not-magnified"),this.buttons.otmagnifier.addClass("highlight")):this.buttons.otmagnifier.removeClass("has-not-magnified")},this)},_getImgsData:function(){var e=this.get("host"),t=e.getSelectedNodes(),n=[],r=[];return t&&t.each(function(e){var t=e.ancestor("img",!0);t&&(t.hasClass("magnifier")?n.push(t):r.push(t))},this),{magnified:n,notmagnified:r}},_addOrRemoveClass:function(){var e=this.get("host"),t=e.getSelectedNodes(),n=this.get("clickhandler");if(t){var r=[],i=0;t.each(function(e){var t=e.ancestor("img",!0);t&&(i++,t.hasClass("magnifier")?r.push(t):(t.addClass("magnifier"),["open","openseparatewindow","openseparatewindowfullscreen"].indexOf(n)!==-1&&t.addClass("magnifier-open"),["openseparatewindow","openseparatewindowfullscreen"].indexOf(n)!==-1&&t.addClass("magnifier-separate-window"),n=="openseparatewindowfullscreen"&&t.addClass("magnifier-fullscreen")))},this),r.length==i&&r.forEach(function(e){e.removeClass("magnifier"),e.removeClass("magnifier-open"),e.removeClass("magnifier-separate-window"),e.removeClass("magnifier-fullscreen")})}}},{ATTRS:{clickhandler:{value:"disabled"}}})},"@VERSION@");
